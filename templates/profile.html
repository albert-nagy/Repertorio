{% extends "skeleton.html" %}
{% block content %}
{% include "header.html" %}
<main>
	<h1>{{ personal_data[0] }}</h1>
	<img src="{{ personal_data[1] }}">
	<section class="userinfo">
		<div class="bio">
			<h2>Biography</h2>
			<span id="bio">
			{% if not personal_data[2] and url != login_session['user_id'] %}
				<p>No biography provided yet..</p>
			{% elif not personal_data[2] and url == login_session['user_id'] %}
			<button class="edit" onclick="getForm('bio', '{{ login_session['user_id'] }}');">Edit Bio</button>
			{% elif personal_data[2] %}
				{{ nl2br(personal_data[2])|safe }}
				{% if url == login_session['user_id'] %}
				<button class="edit" onclick="getForm('bio', '{{ login_session['user_id'] }}');">Edit Bio</button>
				{% endif %}
			{% endif %}
			</span>
		</div>
		{% if url == login_session['user_id'] %}
		<div class="contact">
			<h2>Contact info</h2>
			<p><strong>Email:</strong> {{ personal_data[3] }} 
				{% if personal_data[4] == 0 %}
				<button id="email_privacy" onclick="editContent(this, 'email_privacy', '{{ login_session['user_id'] }}')">Set Public</button>
				{% else %}
				<button id="email_privacy" onclick="editContent(this, 'email_privacy', '{{ login_session['user_id'] }}')">Set Private</button>
				{% endif %}
			</p>
			<span id="contact">
			{% if not personal_data[5] %}
			<p><strong>Phone:</strong> -</p>
			{% else %}
			<p><strong>Phone:</strong> {{ personal_data[5] }}</p>
			{% endif %}
			{% if not personal_data[6] %}
			<p><strong>Address:</strong> -</p>
			{% else %}
			<p><strong>Address:</strong> {{ personal_data[6] }}</p>
			{% endif %}
			<button class="edit" onclick="getForm('contact','{{ login_session['user_id'] }}');">Edit Contact Info</button>
			</span>
		</div>
		{% elif personal_data[4] == 1 or personal_data[5] or personal_data[6] %}
		<div class="contact">
			<h2>Contact info</h2>
			{% if personal_data[4] == 1 %}
			<p><strong>Email:</strong> {{ personal_data[3] }}</p>
			{% endif %}
			{% if personal_data[5] %}
			<p><strong>Phone:</strong> {{ personal_data[5] }}</p>
			{% endif %}
			{% if personal_data[6] %}
			<p><strong>Address:</strong> {{ personal_data[6] }}</p>
			{% endif %}
		</div>
		{% endif %}
		
	</section>
	<section class="repertoire">
		<h2>Repertoire</h2>
		<span id="repertoire">
			{% if url == login_session['user_id'] %}
			<span id="add_work">
				<button class="add" onclick="getForm('add_work','{{ login_session['user_id'] }}');">+ Add Work to your Repertoire</button>
			</span>
			{% endif %}
				{% set i = 0 %}
				{% set instruments = [] %}
				{% set categories = [] %}
				{% for work in works %}
					{# Start with the instrument name (there may be more instruments) #}
					{% if work[4] not in instruments %}
						<h3>{{work[4]}}</h3>
						{% do instruments.append(work[4]) %}
						{% set categories = [] %}
					{% endif %}
					{# Start a new category #}
					{% if work[5] not in categories %}
						{# If this is not the first category, close the previous one first #}
						{% if i != 0 %}
							</div>
						{% endif %}
						{# Over the half of all works start a new column #}
						{% if i <= works|length/2 %}
							<div class="category">
						{% else %}
							<div class="category right">
						{% endif %}
						<h4>{{work[5]}}</h4>
						{% do categories.append(work[5]) %}
					{% endif %}
					<p class="work"><strong>{{work[1]}}:</strong> {{work[2]}} {{work[3]}}'</p>
					{% set i = i + 1 %}
				{% endfor %}
				{# Close the last category #}
				</div>
		</span>
	</section>



</main>
{% endblock %}